---
title: "Tarea 1"
author: "Matías Martínez"
date: "14 de abril de 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,echo=FALSE}
library(tidyverse)
library(gapminder)
```


#### Ejercicio 1:

```{r,echo=TRUE}
ggplot(gapminder,aes(x=lifeExp,y=year,colour=continent))+geom_point()+
  labs(x="Esperanza de vida", y="Año",title="Gráfico de dispersión: Esperanza de vida",caption=paste0(strwrap("Se aprecia un notorio aumento en la esperanza de vida y mediante regresion lineal se denotan los diferentes ritmos correspondientes a cada continente.", 100), sep="", collapse="\n"))+
  coord_cartesian(ylim=c((min(gapminder$year)-5),(max(gapminder$year)+5))) +
  geom_smooth(method = "lm",se=F,position="identity")+ 
  theme(legend.text = element_text(colour="gray20", size=9,face="italic"),plot.title = element_text(hjust = 0.5,colour="slateblue4",size=18,face="italic"),plot.caption=element_text(size=8, hjust=0, margin=margin(t=15)))
```

####Ejercicio 2 

```{r,echo=T}
ggplot(gapminder,aes(x=lifeExp,y=year,colour=continent))+
  labs(x="Esperanza de vida", y="Año",title="Gráfico de dispersión: Esperanza de vida",caption=paste0(strwrap("Se aprecia un notorio aumento en la esperanza de vida y mediante regresion lineal se denotan los diferentes ritmos correspondientes a cada continente.", 100), sep="", collapse="\n"))+
  coord_cartesian(ylim=c((min(gapminder$year)-5),(max(gapminder$year)+5))) +
  geom_smooth(method = "lm",se=F,position="identity")+ 
  theme(legend.text = element_text(colour="gray20", size=9,face="italic"),plot.title = element_text(hjust = 0.5,colour="slateblue4",size=18,face="italic"),plot.caption=element_text(size=8, hjust=0, margin=margin(t=15)))
```


Esto es consecuencia de que no definimos el gráfico de dispersión pero si ordenamos que realice regresión lineal de y sobre x, por lo que mapea nuestra regresion debido a que posee los datos provenientes de nuestro aes().

####Ejercicio 3 

Una visualización más limpia puede estar dada mediante el faceteado por continente. 

```{r, echo = TRUE}
 ggplot(gapminder, aes(x=gdpPercap, y=lifeExp, colour = continent))+geom_point()+facet_wrap(~continent)+labs(x="PBI per cápita en US$",y="Esperanza de vida en años", title="Gráfico de dispersión faceteado por continente.")+theme(plot.title = element_text(hjust = 0.5,colour="indianred4",size=18,face="italic"))
```

Todos los continentes presentan un mapeo similar, evidenciando el aumento en la esperanza de vida y en el plano más reciente, representando cierta tendecia a una alta esdperanza de vida (cercana o superior a los 80 años) y un PBI per cápita creciente. Para el continente asiático, se aprecia que ciertos países gozaron de un alto PBI per cápita aún en tiempos donde la esperanza de vida no era significativa.


####Ejercicio 4


```{r,echo=TRUE}
 ggplot(data= gapminder, aes(x=year,y=gdpPercap, group=country,colour=continent))+geom_line(size = .3) + theme_bw() +facet_wrap(~continent)+labs(x="Año",y="PBI per cápita en US$", title="Gráfico de lineas: PBI per cápita en el tiempo", caption=paste0(strwrap("Es de apreciar la tendencia a crecimiento en el PBI per cápita presente en todos los continentes, no obstante, se distingue el caso de Kuwait y su abrupta caída.
", 90), sep="", collapse="\n"))+theme(plot.title = element_text(hjust = 0.5,colour="lightgoldenrod4",size=17,face="italic"))+scale_color_brewer(palette="Dark2")
```

```{r,echo=TRUE}
head(arrange(filter(gapminder, year==1957),desc(gdpPercap)),4)
```


####Ejercicio 5
```{r,echo=FALSE}
library("plotly")
```
```{r,echo=TRUE}
d=ggplot(data=gapminder,aes(x=lifeExp,y=pop,colour=continent,group=country))+geom_point(aes(frame=year),size=2.1)+labs(x="Esperanza de vida",y="Poblacíon",title="Gráfico de dispersíón: Esperanza de vida según población")+theme(plot.title = element_text(hjust = 0.5,colour="rosybrown4",size=15,face="italic"))
ggplotly(d)%>% animation_opts( 800, redraw = FALSE)
```

Se aprecia claramente la tendencia al crecimiento tanto de la población como de la epseranza de vida, sin embargo, para una visualización más clara obviaremos los casos atipicos(China e India)

```{r,echo =TRUE}
d=ggplot(data=filter(gapminder,country!="India" & country!="China"),aes(x=lifeExp,y=pop,colour=continent,group=country))+geom_point(aes(frame=year),size=2.1)+labs(x="Esperanza de vida",y="Poblacíon",title="Gráfico de dispersíón: Esperanza de vida según población")+theme(plot.title = element_text(hjust = 0.5,colour="palegreen4",size=15,face="italic"))
ggplotly(d)
```

