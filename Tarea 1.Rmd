---
title: "Tarea 1"
author: "Matías Martínez"
date: "14 de abril de 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,echo=TRUE}
library(tidyverse)
library(gapminder)
```


#### Ejercicio 1:

```{r}
ggplot(gapminder,aes(x=lifeExp,y=year,colour=continent))+geom_point()+
  labs(x="Esperanza de vida", y="Año",title="Gráfico de dispersión: Esperanza de vida",caption=paste0(strwrap("Se aprecia un notorio aumento en la esperanza de vida y mediante regresion lineal se denotan los diferentes ritmos correspondientes a cada continente.", 100), sep="", collapse="\n"))+
  coord_cartesian(ylim=c((min(gapminder$year)-5),(max(gapminder$year)+5))) +
  geom_smooth(method = "lm",se=F,position="identity")+ 
  theme(legend.text = element_text(colour="gray20", size=9,face="italic"),plot.title = element_text(hjust = 0.5,colour="slateblue4",size=18,face="italic"),plot.caption=element_text(size=8, hjust=0, margin=margin(t=15)))
```

####Ejercicio 2 

```{r,echo=T}
ggplot(gapminder,aes(x=lifeExp,y=year,colour=continent))+
  labs(x="Esperanza de vida", y="Año",title="Gráfico de dispersión: Esperanza de vida",caption=paste0(strwrap("Se aprecia un notorio aumento en la esperanza de vida y mediante regresion lineal se denotan los diferentes ritmos correspondientes a cada continente.", 100), sep="", collapse="\n"))+
  coord_cartesian(ylim=c((min(gapminder$year)-5),(max(gapminder$year)+5))) +
  geom_smooth(method = "lm",se=F,position="identity")+ 
  theme(legend.text = element_text(colour="gray20", size=9,face="italic"),plot.title = element_text(hjust = 0.5,colour="slateblue4",size=18,face="italic"),plot.caption=element_text(size=8, hjust=0, margin=margin(t=15)))
```


Esto es consecuencia de que no definimos el gráfico de dispersión pero si ordenamos que realice regresión lineal de y sobre x, por lo que mapea nuestra regresion debido a que posee los datos provenientes de nuestro aes().

####Ejercicio 3 

Una visualización más limpia puede estar dada mediante el faceteado por continente. 

```{r, echo = TRUE}
 ggplot(gapminder, aes(x=gdpPercap, y=lifeExp, colour = continent))+geom_point()+facet_wrap(~continent)+labs(x="PBI per cápita",y="Esperanza de vida en años", title="Gráfico de dispersión faceteado por continente.")+theme(plot.title = element_text(hjust = 0.5,colour="indianred4",size=18,face="italic"))
```

Se observa la 

####Ejercicio 4


```{r}
 ggplot(data= gapminder, aes(x=year,y=gdpPercap, group=country,colour=continent))+geom_line(size = .3) + theme_bw() +facet_wrap(~continent)+labs(x="Año",y="PBI per cápita", title="Gráfico de lineas: PBI per cápita en el tiempo")+scale_color_brewer(palette="Dark2")
```

####Ejercicio 5
```{r,echo=FALSE}
library("plotly")
library(devtools)
devtools::install_github('hadley/ggplot2')
```
```{r}
a=ggplot(data=gapminder,aes(y=pop,colour=continent,group=country))+geom_line(aes(frame=year))+facet_wrap(~continent)
ggplotly(a)
```


